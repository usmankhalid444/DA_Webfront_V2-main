var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var h=e[f];if(!(h in d))return;d=d[h]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,h){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:h})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b,c){return c})}},"es8","es3");
var dictSymbols={},historyCache=[],quotesCache=[],allHistoryReceived=!1,allCalculationDone=!1,timeFrameMillis,settings={Interval:1,Periodicity:1,Symbol:{}},useTotalVolume=!1,totalVolume=0,chartDigits=2,timerQuoteUpdate=null,queueRealtime=[],flagProcess=!1,Periodicity={MINUTE:1,HOUR:2,DAY:3,WEEK:4,MONTH:5,YEAR:6},UID="",cache_version="1.0",userClient="",flagRealtimeMode=!1,eventClickByPlatform="click",initRangeMobile=!1,webviewChannel,isDotnetLoadPageFinish=!1,isPlatformTMM=!1;
function setChartDigits(a){chartDigits=a}
function createChart(){StockChartX.Environment.isMobile&&$(window).width();gChart=$("#chartContainer").StockChartX({width:768,height:460,theme:StockChartX.Theme.DarkBlue,fullWindowMode:!1,onToolbarLoaded:function(){window.innerHeight<gChart.size.height&&(gChart.size={width:gChart.size.width,height:window.innerHeight},gChart.update());if(StockChartX.Environment.isMobile&&768>$(window).width()||StockChartX.Environment.isPhone){var a=gChart.container.find(".scxToolbar");a.find(".scxToolbarViewMode").remove();
a=a.children().last();a.hasClass("scxToolbar-delimiter")&&a.remove()}$("#chartContainer .scxToolbar .symbolSearch").focus(function(){$(this).select()})},autoSave:!0});setupChart()}
function setupChart(){gChart.stateHandler.load().then(function(a){a||setupIndicators();setupEventHandlers();setTimeout(function(){gChart.setWindowMode(StockChartX.WindowMode.FULL_WINDOW);gChart.mainPanel.formatter.setDecimalDigits(chartDigits);"undefined"!=typeof eoapi?eoapi.extInvoke("requestInitialData",[]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,functionName:"requestInitialData",value:null})():"undefined"!=typeof webviewChannel&&(triggerResizeChart(),callWebviewChannel("requestInitialData",
[]))},500)}).catch(function(a){StockChartX.UI.Notification.error(a.message);gChart.stateHandler.clear().then(function(){gChart.destroy(!1)})})}function setupIndicators(){gChart.addIndicators(StockChartX.ColoredVolumeIndicator).setParameterValue(StockChartX.IndicatorParam.LINE_WIDTH,5)}
function setupEventHandlers(){gChart.on(StockChartX.ChartEvent.SYMBOL_ENTERED,onSymbolChanged);gChart.on(StockChartX.ChartEvent.TIME_FRAME_CHANGED,onTimeFrameChanged);gChart.on(StockChartX.ChartEvent.MORE_HISTORY_REQUESTED,function(){console.log("TODO: Load more history!")});gChart.on(StockChartX.ChartEvent.USER_DRAWING_FINISHED,function(a){if(a.value&&a.value.className==StockChartX.TrendLineOrderDrawing.className){gChart.toolbar.deactiveTrendlineOrder();a=a.value;gChart.crossHairType=StockChartX.CrossHairType.CROSS_BARS;
var b=a.chartPoints[0].value;"undefined"!=typeof eoapi?eoapi.extInvoke("callConditionform",[settings.Symbol.symbol,b,a.tlType]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,functionName:"callConditionform",value:[settings.Symbol.symbol,b,a.tlType]})():"undefined"!=typeof webviewChannel&&callWebviewChannel("callConditionform",[settings.Symbol.symbol,b,a.tlType])}});gChart.on(StockChartX.DrawingEvent.DRAG_FINISHED,function(a){if(a.target&&a.target.className==StockChartX.TrendLineOrderDrawing.className){var b=
a.target.chartPoints[0].value;a.target.tlType==StockChartX.ConditionOrderType.MARKET_ORDER?"undefined"!=typeof eoapi?eoapi.extInvoke("dragModifyMarketOrder",[a.target.id,b,a.target.tlType]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"dragModifyMarketOrder",value:[a.target.id,b,a.target.tlType]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("dragModifyMarketOrder",[a.target.id,b,a.target.tlType]):"undefined"!=typeof eoapi?eoapi.extInvoke("dragModifyCondition",
[a.target.id,b,a.target.tlType]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"dragModifyCondition",value:[a.target.id,b,a.target.tlType]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("dragModifyCondition",[a.target.id,b,a.target.tlType])}});gChart.on(StockChartX.DrawingEvent.CONTEXT_MENU_SELECTED,function(a){a.target&&a.target.className==StockChartX.TrendLineOrderDrawing.className&&("undefined"!=typeof eoapi?eoapi.extInvoke(a.value,
[a.target.id]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,functionName:a.value,value:[a.target.id]})():"undefined"!=typeof webviewChannel&&callWebviewChannel(a.value,[a.target.id]))});gChart.on(StockChartX.ChartEvent.CONTEXT_MENU,function(a){if("undefined"!=typeof a)switch(a.value){case StockChartX.UI.ChartContextMenu.MenuItem.BUY_CONDITION:a=gChart.mainPanel.projection.valueByY(gChart.mainPanel.lastPointerPosition.y);"undefined"!=typeof eoapi?eoapi.extInvoke("callConditionform",
[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.BUY]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"callConditionform",value:[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.BUY]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.BUY]);break;case StockChartX.UI.ChartContextMenu.MenuItem.SELL_CONDITION:a=gChart.mainPanel.projection.valueByY(gChart.mainPanel.lastPointerPosition.y);
"undefined"!=typeof eoapi?eoapi.extInvoke("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.SELL]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"callConditionform",value:[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.SELL]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.SELL]);break;case StockChartX.UI.ChartContextMenu.MenuItem.TAKEPROFIT_CONDITION:a=
gChart.mainPanel.projection.valueByY(gChart.mainPanel.lastPointerPosition.y);"undefined"!=typeof eoapi?eoapi.extInvoke("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.TAKEPROFIT]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"callConditionform",value:[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.TAKEPROFIT]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("callConditionform",[settings.Symbol.symbol,
a,StockChartX.ConditionOrderType.TAKEPROFIT]);break;case StockChartX.UI.ChartContextMenu.MenuItem.STOPLOSS_CONDITION:a=gChart.mainPanel.projection.valueByY(gChart.mainPanel.lastPointerPosition.y);"undefined"!=typeof eoapi?eoapi.extInvoke("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.STOPLOSS]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"callConditionform",value:[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.STOPLOSS]}),
a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("callConditionform",[settings.Symbol.symbol,a,StockChartX.ConditionOrderType.STOPLOSS]);break;case StockChartX.UI.ChartContextMenu.MenuItem.CLEAR_ALL_CONDITION:"undefined"!=typeof eoapi?eoapi.extInvoke("clearAllConditions",[]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"clearAllConditions",value:[]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("clearAllConditions",[]);break;
case StockChartX.UI.ChartContextMenu.MenuItem.VISIBLE_ONECLICK:"undefined"!=typeof eoapi?eoapi.extInvoke("oneclick",[]):"undefined"!=typeof frameParent()?(a=frameParent().iframeInvokeJS.bind({uid:UID,functionName:"oneclick",value:[]}),a()):"undefined"!=typeof webviewChannel&&callWebviewChannel("oneclick",[]);break;case StockChartX.UI.ChartContextMenu.MenuItem.DELETE_ALL_DRAWINGS:gChart.removeDrawings();gChart.setNeedsUpdate(!0);break;case StockChartX.UI.ChartContextMenu.MenuItem.DELETE_ALL_INDICATORS:gChart.removeIndicators();
gChart.setNeedsUpdate(!0);break;case StockChartX.UI.ChartContextMenu.MenuItem.ADD_INDICATOR:gChart.toolbar._handleIndicatorsClick();break;case StockChartX.UI.ChartContextMenu.MenuItem.THEMES_SETTING:gChart.toolbar._handleThemeClick();break;case StockChartX.UI.ChartContextMenu.MenuItem.VISIBLE_TOOLBAR:$(".scxToolbar").is(":visible")?$(".scxToolbar").hide():$(".scxToolbar").show(),setTimeout(function(){$(window).trigger("resize")},1)}})}
function setupInstruments(){$.get(StockChartX.Environment.isMobile?"data/symbols.mobile.json":"data/symbols.json",function(a){StockChartX.getAllInstruments=function(){return"string"===typeof a?JSON.parse(a):a}})}
function loadBars(){gChart.showWaitingBar();$.get(StockChartX.Environment.isMobile?"data/aapl-1day.mobile.csv":"data/aapl-1day.csv",function(a){parseBars(a);gChart.instrument={symbol:"GOOG",company:"Google Inc.",exchange:"NASDAQ"};gChart.timeInterval=StockChartX.TimeSpan.MILLISECONDS_IN_DAY;gChart.updateIndicators();StockChartX.Environment.isMobile||gChart.recordRange(1E3);gChart.setNeedsUpdate(!0);gChart.hideWaitingBar()}).fail(function(){gChart.hideWaitingBar();StockChartX.UI.Notification.error("Unable to load data file.")})}
function parseBars(a){var b=gChart.barDataSeries();a=a.split("\n");a.reverse();$.each(a,function(c,d){c=d.split(",");d=moment(c[0],"D-MMM-YY").toDate();b.date.add(d);b.open.add(parseFloat(c[1]));b.high.add(parseFloat(c[2]));b.low.add(parseFloat(c[3]));b.close.add(parseFloat(c[4]));b.volume.add(parseInt(c[5],10))});gChart.updateComputedDataSeries()}
function setupInstrumentsSymbol(a){var b=JSON.parse(a);b&&($.each(b,function(c,d){dictSymbols[d.symbol]=d}),StockChartX.getAllInstruments=function(){return b})}
function loadHistoryData(a,b,c,d,e){gChart.showWaitingBar();setTimeout(function(){gChart.hideWaitingBar(!0)},6E3);d=JSON.parse(d);historyCache=[];quotesCache=[];allCalculationDone=allHistoryReceived=!1;settings.Interval=b;settings.Periodicity=c;settings.Symbol=dictSymbols[a];timeFrameMillis=getMillisecondsTimeFrame(settings.Interval,settings.Periodicity);setInstrument(dictSymbols[a].symbol,dictSymbols[a].company,dictSymbols[a].exchange);setTimeFrame(settings.Interval,settings.Periodicity);useTotalVolume=
"Index"==settings.Symbol.exchange;"undefined"!=typeof e&&(totalVolume=parseInt(e));onHistoryReceived(d);1==isPlatformTMM&&setTimeout(function(){adjustResizeChart()},1E3)}function setQuoteUpdate(a){a=JSON.parse(a);setQuoteUpdateProcess(a)}
function setQuoteUpdateProcess(a){queueRealtime.push(a);flagProcess=!0;null==timerQuoteUpdate&&(timerQuoteUpdate=setInterval(function(){if(flagProcess){var b=queueRealtime.length;flagProcess=!1;if(0<b){for(var c=0;c<b;c++){var d=queueRealtime.shift();processQuote(d)}realtimeModeProcess();updateChart(flagRealtimeMode);gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.HEIKIN_ASHI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.RENKO&&gChart.mainPanel.chart.priceStyleKind!=
StockChartX.BarPlot.Style.LINE_BREAK&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.KAGI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.POINT_AND_FIGURE||gChart.mainPanel.chart.priceStyle.apply(!0)}}},1500))}function onQuoteReceived(a){a=JSON.parse(a);onQuoteReceivedProcess(a)}
function onQuoteReceivedProcess(a){if(useTotalVolume){var b=a.TotalVolume-totalVolume;totalVolume=a.TotalVolume;a.Volume=b}allCalculationDone&&(processQuote(a),realtimeModeProcess(),updateChart(flagRealtimeMode));allHistoryReceived||quotesCache.push(a);gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.HEIKIN_ASHI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.RENKO&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.LINE_BREAK&&gChart.mainPanel.chart.priceStyleKind!=
StockChartX.BarPlot.Style.KAGI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.POINT_AND_FIGURE||gChart.mainPanel.chart.priceStyle.apply(!0)}
function onHistoryReceived(a){$.each(a,function(b,c){historyCache.push(c)});allHistoryReceived=!0;processData();allCalculationDone=!0;gChart.hideWaitingBar(!0);gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.HEIKIN_ASHI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.RENKO&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.LINE_BREAK&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.KAGI&&gChart.mainPanel.chart.priceStyleKind!=StockChartX.BarPlot.Style.POINT_AND_FIGURE||
gChart.mainPanel.chart.priceStyle.apply(!0)}
function processData(){var a;gChart.clearDataSeries();if(0<historyCache.length){for(a=0;a<historyCache.length;a++)historyCache[a].Date=moment(historyCache[a].TradeDateTimeString,"YYYY-MM-DD HH:mm:ss").toDate().getTime();for(a=quotesCache.length-1;0<=a;a--)quotesCache[a].Date<historyCache[historyCache.length-1].Date&&quotesCache.splice(a,1);0<historyCache.length&&loadData(historyCache)}$.each(quotesCache,function(c,d){processQuote(d)});updateChart(!0,!0);if(!initRangeMobile&&(StockChartX.Environment.isPhone||
StockChartX.Environment.isMobile)&&"undefined"!=typeof document.ontouchend){initRangeMobile=!0;a=Math.ceil(window.innerWidth/4);50>a&&(a=50);var b=gChart.lastVisibleIndex-gChart.firstVisibleIndex;a<b&&(b=a);gChart.lastVisibleRecord=gChart.recordCount;gChart.firstVisibleRecord=gChart.recordCount-b}}
function processQuote(a){if("object"!=typeof a.Symbol||a.Symbol.Symbol===settings.Symbol.symbol)if("string"!=typeof a.Symbol||a.Symbol===settings.Symbol.symbol){"undefined"!=typeof a.TradeDateTimeString&&(a.Date=moment(a.TradeDateTimeString,"YYYY-MM-DD HH:mm:ss").toDate().getTime());var b=getLastChartBar(),c=null!==b?b.Date:normalizeDate(a.Date,timeFrameMillis/settings.Interval,settings.Interval),d=c+timeFrameMillis;if(!(a.Date<c||0==a.Price||null!=b&&Math.abs(b.Price-a.Price)>.05*b.Price))if(a.Date>=
d||null===b){for(null===b&&a.Date<d&&(d=c);a.Date>=d+timeFrameMillis;)d+=timeFrameMillis;b={Open:a.Price,High:a.Price,Low:a.Price,Close:a.Price,Volume:a.Volume,Date:d,BuyVolume:0,SellVolume:0};"B"==a.Side?b.BuyVolume=a.Volume:"S"==a.Side&&(b.SellVolume=a.Volume);appendBar(b)}else b.Close=a.Price,b.Volume+=a.Volume,b.High<a.Price&&(b.High=a.Price),b.Low>a.Price&&(b.Low=a.Price),"B"==a.Side?b.BuyVolume+=a.Volume:"S"==a.Side&&(b.SellVolume+=a.Volume),updateLastBar(b)}}
function normalizeDate(a,b,c){var d=new Date(a);return b===StockChartX.TimeSpan.MILLISECONDS_IN_YEAR?(new Date(parseInt(d.getFullYear()/c)*c,0,1)).getTime():b===StockChartX.TimeSpan.MILLISECONDS_IN_MONTH?(new Date(d.getFullYear(),parseInt(d.getMonth()/c)*c,1)).getTime():b===StockChartX.TimeSpan.MILLISECONDS_IN_WEEK?(new Date(d.getFullYear(),d.getMonth(),parseInt(d.getDate()/(7*c))*c*7)).getTime():b===StockChartX.TimeSpan.MILLISECONDS_IN_DAY?(new Date(d.getFullYear(),d.getMonth(),parseInt(d.getDate()/
c)*c)).getTime():b===StockChartX.TimeSpan.MILLISECONDS_IN_HOUR?(new Date(d.getFullYear(),d.getMonth(),d.getDate(),parseInt(d.getHours()/c)*c)).getTime():b===StockChartX.TimeSpan.MILLISECONDS_IN_MINUTE?(new Date(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),parseInt(d.getMinutes()/c)*c)).getTime():a}
function getLastChartBar(){var a=gChart.getCommonDataSeries();if(0==a.open.values.length)return null;var b=a.open.values.length-1;return{Open:a.open.values[b],High:a.high.values[b],Low:a.low.values[b],Close:a.close.values[b],Volume:a.volume.values[b],Date:a.date.values[b].getTime(),BuyVolume:a.buy_volume.values[b],SellVolume:a.sell_volume.values[b]}}function loadData(a){gChart.appendBars(convertBars(a))}function appendBar(a){gChart.appendBars(convertBars([a]));gChart.setNeedsAutoScale()}
function updateLastBar(a){var b=gChart.getCommonDataSeries(),c=b.open.values.length-1;b.open.values[c]=a.Open;b.high.values[c]=a.High;b.low.values[c]=a.Low;b.close.values[c]=a.Close;b.volume.values[c]=a.Volume;b.date.values[c]=new Date(a.Date);b.buy_volume.values[c]=a.BuyVolume;b.sell_volume.values[c]=a.SellVolume}function updateChart(a,b){a&&!b&&gChart.setNeedsAutoScale();b&&gChart.setNeedsAutoScaleAll();gChart.updateIndicators();gChart.update()}function updateChartOnly(){gChart.update()}
function convertBars(a){return $.map(a,function(b){return{open:b.Open,high:b.High,low:b.Low,close:b.Close,volume:b.Volume,date:new Date(b.Date),buy_volume:b.BuyVolume,sell_volume:b.SellVolume}})}function setInstrument(a,b,c){gChart.instrument={symbol:a,company:b||"",exchange:c||""}}function setTimeFrame(a,b){gChart.timeInterval=getMillisecondsTimeFrame(a,b)}
function getMillisecondsTimeFrame(a,b){switch(parseInt(b)){case Periodicity.MINUTE:return a*StockChartX.TimeSpan.MILLISECONDS_IN_MINUTE;case Periodicity.HOUR:return a*StockChartX.TimeSpan.MILLISECONDS_IN_HOUR;case Periodicity.DAY:return a*StockChartX.TimeSpan.MILLISECONDS_IN_DAY;case Periodicity.WEEK:return a*StockChartX.TimeSpan.MILLISECONDS_IN_WEEK;case Periodicity.MONTH:return a*StockChartX.TimeSpan.MILLISECONDS_IN_MONTH;case Periodicity.YEAR:return a*StockChartX.TimeSpan.MILLISECONDS_IN_YEAR}return 0}
function adjustDimensions(){gChart.size={width:window.innerWidth-20,height:window.innerHeight-80};updateChart(!0)}
function onSymbolChanged(a){gChart.showWaitingBar();var b=StockChartX.TimeFrame.timeIntervalToTimeFrame(timeFrameMillis);"undefined"!=typeof eoapi?eoapi.extInvoke("getHistory",[a.value.symbol,b.interval,b.periodicity]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,functionName:"getHistory",value:[a.value.symbol,b.interval,b.periodicity]})():"undefined"!=typeof webviewChannel&&callWebviewChannel("getHistory",[a.value.symbol,b.interval,b.periodicity])}
function onTimeFrameChanged(a){gChart.showWaitingBar();"undefined"!=typeof eoapi?eoapi.extInvoke("getHistory",[settings.Symbol.symbol,a.value.interval,a.value.periodicity]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,functionName:"getHistory",value:[settings.Symbol.symbol,a.value.interval,a.value.periodicity]})():"undefined"!=typeof webviewChannel&&callWebviewChannel("getHistory",[settings.Symbol.symbol,a.value.interval,a.value.periodicity])}
function getTempData(){setupInstrumentsSymbol('[{"company":"PTT PUBLIC COMPANY LIMITED","exchange":"Equity","symbol":"PTT"}, {"company":"SCB COMPANY LIMITED","exchange":"Equity","symbol":"SCB"}]');$.get("data.asp",function(a){loadHistoryData("PTT",1,3,a)})}
function addTrendlineOrder(a,b,c,d,e,f,h){var g=StockChartX.Drawing.deserialize({className:StockChartX.TrendLineOrderDrawing.className});g.chartPanel=gChart.mainPanel;var k=g._normalizeUserDrawingPoint({x:0,y:0});k.value=c;g.appendChartPoint(k);k=$.extend(!0,{},g.actualTheme);k.line.lineStyle=StockChartX.LineStyle.DASH;k.line.strokeColor=d;g.theme=k;g.id=a;g.title=b;g.chartPoints[0].value=c;g.tlType=e;g.selected=!1;g.chartPanel.addTrendlineOrder(g);"undefined"!=typeof f&&1==f&&(g.locked=!0);"undefined"!=
typeof h&&1==h&&(g.selectable=!1);gChart.crossHairType=StockChartX.CrossHairType.NONE}function updateTrendlineOrder(a,b,c,d){gChart.mainPanel.updateTrendlineOrder(a,b,c,d)}function removeTrendlineOrder(a){gChart.mainPanel.removeTrendlineOrder(a)}function realtimeMode(a){flagRealtimeMode=a;realtimeModeProcess();updateChart(!0)}
function realtimeModeProcess(){if(flagRealtimeMode){var a=gChart.lastVisibleIndex-gChart.firstVisibleIndex;gChart.lastVisibleRecord=gChart.recordCount;gChart.firstVisibleRecord=gChart.recordCount-a}}$(document).ready(function(){onDocumentReady()});
function onDocumentReady(){if("dtbrowser"!=getUrlParameter("platform")||0!=isDotnetLoadPageFinish)!localStorage||null!=localStorage.getItem("cache_version")&&localStorage.getItem("cache_version")==cache_version||(localStorage.clear(),localStorage.setItem("cache_version",cache_version)),UID=getUrlParameter("uid"),isPlatformTMM="tmm"==getUrlParameter("app"),webviewChannel=window.webviewChannel,"undefined"!=typeof eoapi?eoapi.extInvoke("loadSymbols",[]):"undefined"!=typeof frameParent()?frameParent().iframeInvokeJS.bind({uid:UID,
functionName:"loadSymbols",value:[getUrlParameter("symbol")]})():"undefined"!=typeof webviewChannel&&callWebviewChannel("loadSymbols",[]),userClient=getUrlParameter("user"),userClient=""!=userClient?decodeURIComponent(userClient):"test",eventClickByPlatform=(StockChartX.Environment.isPhone||StockChartX.Environment.isMobile)&&"undefined"!=typeof document.ontouchend?"touchend":"click"}function initialChart(a){setupInstrumentsSymbol(a);createChart();adjustDimensions()}
function identifyIniFrame(){return window.self!==window.top?!0:!1}function frameParent(){if(0!=identifyIniFrame())return window.parent}function getUrlParameter(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function callWebviewChannel(a,b){"undefined"!=typeof window[a]&&window[a].postMessage(b.join("|"))}
function adjustResizeChart(){setTimeout(function(){gChart.setWindowMode(StockChartX.WindowMode.FULL_WINDOW);$(window).trigger("resize")},800)}function triggerResizeChart(){setTimeout(function(){try{gChart.setWindowMode(StockChartX.WindowMode.NORMAL),$(window).trigger("resize")}catch(a){}setTimeout(function(){try{gChart.setWindowMode(StockChartX.WindowMode.FULL_WINDOW),$(window).trigger("resize")}catch(a){}},300)},300)}
function initEventInjectingJS(){"undefined"==typeof window.eoapi&&(window.eoapi={},window.eoapi.extInvoke=function(a,b){"undefined"!=typeof dotnetapi&&setTimeout(function(){dotnetapi.extInvoke(a,JSON.stringify(b))},1)});isDotnetLoadPageFinish=!0;onDocumentReady()};
